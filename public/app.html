<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yipp.app - Food Discovery & Menu Explorer</title>
    <link rel="stylesheet" href="./app-styles.css">
</head>
<body>
    <!-- Global Header -->
    <header class="global-header">
        <div class="header-content">
            <div class="logo">
                <h1>Yipp.app</h1>
            </div>
            
            <!-- Global Search Bar with Filters -->
            <div class="search-container">
                <div class="search-wrapper">
                    <input type="text" id="globalSearch" placeholder="Search restaurants, dishes, or cuisines..." class="search-input">
                    <button class="search-btn">üîç</button>
                    <button class="filter-btn" id="filterToggle">üéõÔ∏è Filters</button>
                    <button class="clear-filters-btn" id="clearFilters" style="display: none;">‚úï Clear</button>
                </div>
                
                <!-- Filter Panel (Collapsible) -->
                <div class="filter-panel" id="filterPanel" style="display: none;">
                    <div class="filter-section">
                        <h3>Dietary Preferences</h3>
                        <div class="filter-tags">
                            <label class="filter-tag vegan"><input type="checkbox" value="vegan"> Vegan</label>
                            <label class="filter-tag vegetarian"><input type="checkbox" value="vegetarian"> Vegetarian</label>
                            <label class="filter-tag meat"><input type="checkbox" value="meat-eater"> Meat-Eater</label>
                            <label class="filter-tag gluten-free"><input type="checkbox" value="gluten-free"> Gluten-Free</label>
                            <label class="filter-tag dairy-free"><input type="checkbox" value="dairy-free"> Dairy-Free</label>
                        </div>
                    </div>
                    
                    <div class="filter-section">
                        <h3>Nutritional Focus</h3>
                        <div class="filter-tags">
                            <label class="filter-tag protein"><input type="checkbox" value="high-protein"> High Protein</label>
                            <label class="filter-tag"><input type="checkbox" value="low-calorie"> Low Calorie</label>
                            <label class="filter-tag"><input type="checkbox" value="high-fiber"> High Fiber</label>
                            <label class="filter-tag"><input type="checkbox" value="low-carb"> Low Carb</label>
                        </div>
                    </div>
                    
                    <div class="filter-section">
                        <h3>Allergens to Avoid</h3>
                        <div class="filter-tags">
                            <label class="filter-tag allergen"><input type="checkbox" value="nuts"> Nuts</label>
                            <label class="filter-tag allergen"><input type="checkbox" value="dairy"> Dairy</label>
                            <label class="filter-tag allergen"><input type="checkbox" value="gluten"> Gluten</label>
                            <label class="filter-tag allergen"><input type="checkbox" value="shellfish"> Shellfish</label>
                            <label class="filter-tag allergen"><input type="checkbox" value="soy"> Soy</label>
                        </div>
                    </div>
                    
                    <div class="filter-section">
                        <h3>Price Range</h3>
                        <div class="price-range">
                            <input type="range" min="0" max="100" value="100" id="priceRange">
                            <span id="priceValue">$0 - $100</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Shopping List Icon -->
            <div class="shopping-list-icon" id="shoppingListIcon" style="display: none;">
                <button class="icon-btn" onclick="openShoppingList()">
                    üõí <span class="badge" id="cartCount">0</span>
                </button>
            </div>
        </div>
        
        <!-- Navigation Tabs -->
        <nav class="main-nav">
            <button class="nav-tab active" data-page="map">üó∫Ô∏è Map</button>
            <button class="nav-tab" data-page="restaurant-list">üìã Restaurant List</button>
            <button class="nav-tab" data-page="socials">üí¨ Socials</button>
            <button class="nav-tab" data-page="user">üë§ User</button>
            <button class="nav-tab admin-only" data-page="upload" style="display: none;">‚öôÔ∏è Admin</button>
        </nav>
    </header>
    
    <!-- Main Content Area -->
    <main class="main-content">
        <!-- Map View -->
        <section id="map-page" class="page-content active">
            <div class="map-container">
                <div id="map" class="map-view">
                    <div class="map-placeholder">
                        <p>üó∫Ô∏è Interactive Map View</p>
                        <p class="sub-text">Map integration coming soon (Google Maps API)</p>
                    </div>
                </div>
                
                <!-- Map Sidebar -->
                <div class="map-sidebar">
                    <h3>Nearby Restaurants</h3>
                    <div class="restaurant-quick-list" id="mapRestaurantList">
                        <!-- Populated dynamically -->
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Restaurant List View -->
        <section id="restaurant-list-page" class="page-content">
            <div class="list-controls">
                <div class="sort-options">
                    <label>Sort by:</label>
                    <select id="sortBy">
                        <option value="distance">Distance</option>
                        <option value="rating">Rating</option>
                        <option value="price-low">Price (Low to High)</option>
                        <option value="price-high">Price (High to Low)</option>
                    </select>
                </div>
                
                <!-- Filter Button for Restaurant List -->
                <button class="filter-btn" id="restaurantListFilterBtn">üéõÔ∏è Filters</button>
                
                <div class="view-toggle">
                    <button class="view-btn active" data-view="grid">‚äû Grid</button>
                    <button class="view-btn" data-view="list">‚ò∞ List</button>
                </div>
            </div>
            
            <!-- Active Filter Pills -->
            <div class="active-filters-container" id="activeFiltersContainer" style="display: none;">
                <div class="active-filters-header">
                    <span class="active-filters-label">Active Filters:</span>
                    <button class="clear-all-filters-btn" id="clearAllFiltersBtn">‚úï Clear All</button>
                </div>
                <div class="active-filter-pills" id="activeFilterPills">
                    <!-- Filter pills populated dynamically -->
                </div>
            </div>
            
            <div class="restaurant-grid" id="restaurantGrid">
                <!-- Restaurant cards populated dynamically -->
            </div>
        </section>
        
        <!-- Socials View -->
        <section id="socials-page" class="page-content">
            <div class="socials-container">
                <div class="post-composer">
                    <textarea placeholder="Share your food discovery..." id="newPost"></textarea>
                    <div class="composer-actions">
                        <button class="btn-primary">üìù Post</button>
                        <button class="btn-secondary">üì∑ Add Photo</button>
                    </div>
                </div>
                
                <!-- Social Timeline -->
                <div class="social-timeline" id="socialTimeline">
                    <!-- Posts populated dynamically -->
                </div>
                
                <div class="load-more-container">
                    <button class="btn-secondary" id="loadMorePosts">Load More Posts</button>
                </div>
            </div>
        </section>
        
        <!-- User Profile View -->
        <section id="user-page" class="page-content">
            <div class="user-profile-container">
                <div class="profile-header">
                    <div class="profile-avatar">üë§</div>
                    <div class="profile-info">
                        <h2 id="userName">Guest User</h2>
                        <p id="userLocation">üìç Location not set</p>
                    </div>
                    <button class="btn-primary" onclick="editProfile()">‚úèÔ∏è Edit Profile</button>
                </div>
                
                <!-- Profile Sections -->
                <div class="profile-sections">
                    <!-- Favorites -->
                    <div class="profile-section">
                        <h3>‚ù§Ô∏è Favorites</h3>
                        <div class="favorites-list" id="favoritesList">
                            <p class="empty-state">No favorites yet. Start exploring!</p>
                        </div>
                    </div>
                    
                    <!-- Preferences -->
                    <div class="profile-section">
                        <h3>‚öôÔ∏è App Preferences</h3>
                        <div class="preferences-form">
                            <div class="pref-group">
                                <label>Default Dietary Filter:</label>
                                <select id="defaultDiet" multiple>
                                    <option value="vegan">Vegan</option>
                                    <option value="vegetarian">Vegetarian</option>
                                    <option value="high-protein">High Protein</option>
                                    <option value="gluten-free">Gluten-Free</option>
                                </select>
                            </div>
                            
                            <div class="pref-group">
                                <label>Notification Preferences:</label>
                                <div class="checkbox-group">
                                    <label><input type="checkbox" id="notifProximity"> Location-based alerts</label>
                                    <label><input type="checkbox" id="notifFavorites"> Favorite restaurant updates</label>
                                    <label><input type="checkbox" id="notifPrice"> Price change alerts</label>
                                    <label><input type="checkbox" id="notifReduced"> Reduce notification frequency</label>
                                </div>
                            </div>
                            
                            <button class="btn-primary" onclick="savePreferences()">üíæ Save Preferences</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Upload/Admin View -->
        <section id="upload-page" class="page-content">
            <div class="upload-container">
                <h2>üì§ Upload Restaurant Data</h2>
                
                <div class="upload-form">
                    <div class="upload-type">
                        <label>Upload Type:</label>
                        <select id="uploadType">
                            <option value="restaurant">Restaurant</option>
                            <option value="menu">Menu</option>
                            <option value="item">Menu Item</option>
                        </select>
                    </div>
                    
                    <div class="file-upload">
                        <label class="upload-area" for="fileInput">
                            <div class="upload-icon">üìÅ</div>
                            <p>Drop files here or click to browse</p>
                            <p class="sub-text">CSV, JSON, Image (PNG/JPEG), PDF</p>
                            <input type="file" id="fileInput" accept=".csv,.json,.png,.jpg,.jpeg,.pdf" multiple>
                        </label>
                    </div>
                    
                    <div class="ai-prompt">
                        <label>AI Analysis Prompt (optional):</label>
                        <textarea id="aiPrompt" placeholder="e.g., 'Restaurant is entirely vegan with organic ingredients...'"></textarea>
                    </div>
                    
                    <div class="upload-actions">
                        <button class="btn-primary" onclick="processUpload()">ü§ñ Analyze with AI</button>
                        <button class="btn-secondary" onclick="manualEntry()">‚úèÔ∏è Manual Entry</button>
                    </div>
                </div>
                
                <!-- Preview Area -->
                <div class="upload-preview" id="uploadPreview" style="display: none;">
                    <h3>Preview & Edit Data</h3>
                    <div id="previewContent"></div>
                    <button class="btn-primary" onclick="submitToDatabase()">‚úÖ Submit to Database</button>
                </div>
            </div>
        </section>
    </main>
    
    <!-- Modals -->
    
    <!-- Restaurant Detail Modal -->
    <div class="modal" id="restaurantModal">
        <div class="modal-overlay" onclick="closeModal('restaurantModal')"></div>
        <div class="modal-content large">
            <button class="modal-close" onclick="closeModal('restaurantModal')">‚úï</button>
            
            <div class="restaurant-detail">
                <!-- Restaurant Header -->
                <div class="restaurant-header">
                    <div class="restaurant-images">
                        <div class="image-carousel" id="restaurantCarousel">
                            <!-- Images populated dynamically -->
                        </div>
                    </div>
                    
                    <div class="restaurant-info-detail">
                        <h2 id="modalRestaurantName"></h2>
                        <p id="modalRestaurantDescription"></p>
                        
                        <!-- Restaurant Tags Section - Below Description -->
                        <div class="restaurant-tags-section" id="restaurantTagsSection">
                            <div class="restaurant-tags-container" id="modalRestaurantTags">
                                <!-- Tags populated dynamically -->
                            </div>
                        </div>
                        
                        <!-- Ratings Section - Multiple Sources -->
                        <div class="ratings-section" id="ratingsSection">
                            <div class="ratings-container" id="ratingsContainer">
                                <!-- Ratings populated dynamically -->
                            </div>
                        </div>
                        
                        <!-- Restaurant Actions (Like/Dislike/Save) -->
                        <div class="restaurant-actions" id="restaurantActions">
                            <button class="action-btn like-restaurant-btn" onclick="handleRestaurantPageLike()" title="Like">
                                <span class="action-icon">üëç</span>
                                <span class="action-label">Like</span>
                            </button>
                            <button class="action-btn dislike-restaurant-btn" onclick="handleRestaurantPageDislike()" title="Dislike">
                                <span class="action-icon">üëé</span>
                                <span class="action-label">Dislike</span>
                            </button>
                            <button class="action-btn save-restaurant-btn" onclick="handleRestaurantSave()" title="Save">
                                <span class="action-icon">üîñ</span>
                                <span class="action-label">Save</span>
                            </button>
                        </div>
                        
                        <!-- Contact Info - Hidden if multiple locations -->
                        <div class="contact-info" id="singleLocationContact">
                            <div class="contact-item">
                                <span>üìç</span>
                                <span id="modalRestaurantAddress"></span>
                            </div>
                            <div class="contact-item">
                                <span>üìû</span>
                                <span id="modalRestaurantPhone"></span>
                                <button class="copy-btn" onclick="copyText('phone')">üìã</button>
                            </div>
                            <div class="contact-item">
                                <span>üìß</span>
                                <span id="modalRestaurantEmail"></span>
                                <button class="copy-btn" onclick="copyText('email')">üìã</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Disclaimer -->
                <div class="disclaimer" id="restaurantDisclaimer">
                    <span class="disclaimer-icon">‚ö†Ô∏è</span>
                    <p><strong>Disclaimer:</strong> Restaurant information and data is not verified by the restaurant. Always contact the restaurant for further information regarding allergens, dietary needs, location, price updates.</p>
                    <button class="disclaimer-collapse" onclick="collapseDisclaimer(this)">Collapse</button>
                </div>
                
                <!-- Location Cards Section - Collapsible -->
                <div class="collapsible-section" id="locationCardsSection">
                    <div class="collapsible-header" onclick="toggleCollapsibleSection('locationCardsSection')">
                        <h3>üìç Locations</h3>
                        <span class="collapse-icon">‚ñº</span>
                    </div>
                    <div class="collapsible-content">
                        <div class="location-cards-container" id="locationCardsContainer">
                            <!-- Location cards populated dynamically -->
                        </div>
                    </div>
                </div>
                
                <!-- Contact Section - Collapsible (with Map inside) -->
                <div class="collapsible-section" id="contactSection">
                    <div class="collapsible-header" onclick="toggleCollapsibleSection('contactSection')">
                        <h3>üìû Contact</h3>
                        <span class="collapse-icon">‚ñº</span>
                    </div>
                    <div class="collapsible-content">
                        <div class="contact-details" id="contactDetails">
                            <!-- Contact info populated dynamically for multi-location -->
                        </div>
                        <div class="local-map" id="localMap">
                            <div class="map-placeholder-small">Local Map View</div>
                        </div>
                    </div>
                </div>
                
                <!-- Menu Section -->
                <div class="menu-section">
                    <div class="menu-header">
                        <h3>Menu</h3>
                        <!-- Menu Selector Dropdown -->
                        <div class="menu-selector">
                            <select id="menuSelector" onchange="handleMenuSelection()">
                                <option value="all">All Items</option>
                                <!-- Menu options populated dynamically -->
                            </select>
                        </div>
                        <div class="menu-search-bar">
                            <input type="text" placeholder="Search by price, diet, nutrition, tags, customization..." id="menuSearch" oninput="handleMenuSearch()">
                            <button class="filter-btn" onclick="toggleMenuFilters()">üéõÔ∏è Filters</button>
                        </div>
                    </div>
                    
                    <!-- Active Menu Tag Filters -->
                    <div class="menu-active-filters" id="menuActiveFilters" style="display: none;">
                        <span class="filter-label">Filtering by:</span>
                        <div class="menu-filter-pills" id="menuFilterPills"></div>
                        <button class="clear-menu-filters-btn" onclick="clearMenuTagFilters()">‚úï Clear</button>
                    </div>
                    
                    <!-- Menu Filters -->
                    <div class="menu-filters" id="menuFilters" style="display: none;">
                        <div class="quick-filter-presets">
                            <button class="preset-btn" data-preset="vegan">Vegan Only</button>
                            <button class="preset-btn" data-preset="high-protein">High Protein</button>
                            <button class="preset-btn" data-preset="low-carb">Low Carb</button>
                            <button class="preset-btn" data-preset="gluten-free">Gluten-Free</button>
                        </div>
                    </div>
                    
                    <!-- Menu Items -->
                    <div class="menu-items-list" id="menuItemsList">
                        <!-- Menu items populated dynamically -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Nutrition Modal -->
    <div class="modal" id="nutritionModal">
        <div class="modal-overlay" onclick="closeModal('nutritionModal')"></div>
        <div class="modal-content medium">
            <button class="modal-close" onclick="closeModal('nutritionModal')">‚úï</button>
            
            <h2>Nutrition & Ingredients</h2>
            
            <!-- Verification Disclaimer - PROMINENT at TOP -->
            <div class="disclaimer prominent-warning">
                <span class="disclaimer-icon">‚ö†Ô∏è</span>
                <p><strong>Important:</strong> Nutrition information is user-submitted and may not be accurate. Always verify with the restaurant for allergen and dietary concerns.</p>
            </div>
            
            <!-- Customization Options Section (from menu_item_customization) -->
            <div class="customization-options-section" id="nutritionCustomizationSection">
                <h3>Customization Options</h3>
                <p class="help-text">Select/deselect options to update nutrition in real-time</p>
                <div class="customization-options-list" id="nutritionCustomizationList">
                    <!-- Populated dynamically with checkboxes -->
                </div>
            </div>
            
            <!-- Ingredients Checklist -->
            <div class="ingredients-section">
                <h3>Ingredients</h3>
                <p class="help-text">Uncheck items to remove them and update nutrition automatically</p>
                <div class="ingredients-checklist" id="ingredientsList">
                    <!-- Populated dynamically -->
                </div>
            </div>
            
            <!-- Nutrition Stats -->
            <div class="nutrition-stats" id="nutritionStats">
                <!-- Populated dynamically -->
            </div>
            
            <!-- Option Values for Customizable Items -->
            <div class="option-values-section" id="optionValuesSection" style="display: none;">
                <h3>Currently Selected Options</h3>
                <div id="optionValuesList"></div>
            </div>
            
            <div class="modal-actions">
                <button class="btn-secondary" onclick="generateItemImage()">üé® Generate Image</button>
                <button class="btn-primary" onclick="saveCustomization()">üíæ Save Configuration</button>
            </div>
        </div>
    </div>
    
    <!-- Make It Modal (Auto-Customization) -->
    <div class="modal" id="makeItModal">
        <div class="modal-overlay" onclick="closeModal('makeItModal')"></div>
        <div class="modal-content medium">
            <button class="modal-close" onclick="closeModal('makeItModal')">‚úï</button>
            
            <h2>üéØ Make It Your Way</h2>
            <p class="help-text">Auto-selecting options based on your preferences...</p>
            
            <div class="preference-selection">
                <label><input type="checkbox" value="vegan" checked> Vegan</label>
                <label><input type="checkbox" value="high-protein" checked> High-Protein</label>
                <label><input type="checkbox" value="low-calorie"> Low Calorie</label>
                <label><input type="checkbox" value="high-fiber"> High Fiber</label>
            </div>
            
            <div class="auto-selected-options" id="autoSelectedOptions">
                <!-- Populated dynamically -->
            </div>
            
            <div class="modal-actions">
                <button class="btn-secondary" onclick="undoMakeIt()">‚Ü©Ô∏è Undo</button>
                <button class="btn-primary" onclick="applyMakeIt()">‚úÖ Apply</button>
            </div>
        </div>
    </div>
    
    <!-- Translate Modal -->
    <div class="modal" id="translateModal">
        <div class="modal-overlay" onclick="closeModal('translateModal')"></div>
        <div class="modal-content medium">
            <button class="modal-close" onclick="closeModal('translateModal')">‚úï</button>
            
            <h2>üåç Order Translation</h2>
            
            <div class="language-selection">
                <label>Select Language:</label>
                <select id="translateLanguage">
                    <option value="es">Spanish</option>
                    <option value="fr">French</option>
                    <option value="de">German</option>
                    <option value="it">Italian</option>
                    <option value="ja">Japanese</option>
                    <option value="ko">Korean</option>
                    <option value="zh">Chinese</option>
                </select>
            </div>
            
            <div class="translation-output" id="translationOutput">
                <!-- Generated translation script -->
            </div>
            
            <button class="btn-primary" onclick="copyTranslation()">üìã Copy Script</button>
        </div>
    </div>
    
    <!-- Shopping List Modal -->
    <div class="modal" id="shoppingListModal">
        <div class="modal-overlay" onclick="closeModal('shoppingListModal')"></div>
        <div class="modal-content large">
            <button class="modal-close" onclick="closeModal('shoppingListModal')">‚úï</button>
            
            <h2>üõí Order List</h2>
            
            <!-- Translate Button - Only shown on Shopping List -->
            <div class="shopping-list-translate">
                <button class="btn-secondary" onclick="openTranslateForShoppingList()">üåç Translate Order</button>
            </div>
            
            <div class="shopping-list-content" id="shoppingListContent">
                <!-- Grouped by restaurant -->
            </div>
            
            <div class="modal-actions">
                <button class="btn-secondary" onclick="exportShoppingList()">üì§ Export</button>
                <button class="btn-primary" onclick="clearShoppingList()">üóëÔ∏è Clear List</button>
            </div>
        </div>
    </div>
    
    <!-- Image Generation Modal -->
    <div class="modal" id="imageGenModal">
        <div class="modal-overlay" onclick="closeModal('imageGenModal')"></div>
        <div class="modal-content medium">
            <button class="modal-close" onclick="closeModal('imageGenModal')">‚úï</button>
            
            <h2>üé® Generated Image</h2>
            
            <div class="generated-image-container" id="generatedImageContainer">
                <div class="loading-spinner">Generating image...</div>
            </div>
            
            <button class="btn-primary" onclick="downloadImage()">‚¨áÔ∏è Download</button>
        </div>
    </div>
    
    <script src="./app.js"></script>
</body>
</html>

